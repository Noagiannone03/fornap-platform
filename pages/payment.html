<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paiement - FORNAP</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/components.css">
</head>
<body>
    <!-- Placeholder pour la navbar - sera remplac√©e par le composant -->
    <div id="navbar-placeholder"></div>

    <!-- ========================================
         CONTENU PRINCIPAL
         ======================================== -->
    <main class="main-content">
        
        <!-- Barre de progression -->
        <section class="progress-section">
            <div class="container">
                <div class="progress-bar">
                    <div class="progress-step completed">
                        <div class="step-number">1</div>
                        <div class="step-label">Forfait</div>
                    </div>
                    <div class="progress-line completed"></div>
                    <div class="progress-step active" id="currentStep">
                        <div class="step-number">2</div>
                        <div class="step-label">Compte</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step">
                        <div class="step-number">3</div>
                        <div class="step-label">Paiement</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step">
                        <div class="step-number">4</div>
                        <div class="step-label">Infos</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section R√©capitulatif Forfait -->
        <section class="selected-plan-section">
            <div class="container">
                <div class="plan-summary-card" id="planSummary">
                    <!-- Contenu g√©n√©r√© dynamiquement -->
                </div>
            </div>
        </section>

        <!-- Section Authentification -->
        <section id="authSection" class="auth-section">
            <div class="container">
                <div class="auth-container">
                    <div class="auth-card">
                        <div class="auth-header">
                            <h2>Cr√©er votre compte FORNAP</h2>
                            <p>Pour finaliser votre adh√©sion, cr√©ez votre compte membre ou connectez-vous si vous en avez d√©j√† un.</p>
                        </div>

                        <!-- Formulaire Inscription -->
                        <div id="signupForm" class="auth-form">
                            <h3>Nouvelle inscription</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="signupFirstName">Pr√©nom</label>
                                    <input type="text" id="signupFirstName" class="input-field" placeholder="Jean" required>
                                </div>
                                <div class="form-group">
                                    <label for="signupLastName">Nom</label>
                                    <input type="text" id="signupLastName" class="input-field" placeholder="Dupont" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="signupEmail">Email</label>
                                <input type="email" id="signupEmail" class="input-field" placeholder="votre@email.com" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="signupPassword">Mot de passe</label>
                                <input type="password" id="signupPassword" class="input-field" placeholder="Minimum 6 caract√®res" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="signupConfirmPassword">Confirmer le mot de passe</label>
                                <input type="password" id="signupConfirmPassword" class="input-field" placeholder="Confirmez votre mot de passe" required>
                            </div>
                            
                            <button type="button" id="signupBtn" class="btn btn-primary btn-full btn-large">
                                Cr√©er mon compte
                            </button>
                        </div>

                        <!-- S√©parateur -->
                        <div class="auth-separator">
                            <div class="separator-line"></div>
                            <span class="separator-text">ou</span>
                            <div class="separator-line"></div>
                        </div>

                        <!-- Formulaire Connexion -->
                        <div id="loginForm" class="auth-form">
                            <h3>D√©j√† membre ?</h3>
                            
                            <div class="form-group">
                                <label for="loginEmail">Email</label>
                                <input type="email" id="loginEmail" class="input-field" placeholder="votre@email.com" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="loginPassword">Mot de passe</label>
                                <input type="password" id="loginPassword" class="input-field" placeholder="Votre mot de passe" required>
                            </div>
                            
                            <button type="button" id="loginBtn" class="btn btn-secondary btn-full btn-large">
                                Se connecter
                            </button>
                            
                            <p class="text-center mt-4">
                                <a href="#" class="forgot-password">Mot de passe oubli√© ?</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Paiement -->
        <section id="paymentSection" class="payment-section hidden">
            <div class="container">
                <div class="payment-container">
                    <div class="payment-card">
                        <div class="payment-header">
                            <h2>Finaliser votre paiement</h2>
                            <p class="demo-notice">
                                üé≠ <strong>Mode D√©mo</strong> - Simulation de paiement. Aucun montant ne sera d√©bit√©.
                            </p>
                        </div>

                        <!-- M√©thodes de paiement -->
                        <div class="payment-methods">
                            <h3>M√©thode de paiement</h3>
                            <div class="method-options">
                                <label class="method-option active">
                                    <input type="radio" name="paymentMethod" value="card" checked>
                                    <div class="method-content">
                                        <span class="method-icon">üí≥</span>
                                        <span class="method-name">Carte bancaire</span>
                                    </div>
                                </label>
                                <label class="method-option">
                                    <input type="radio" name="paymentMethod" value="paypal">
                                    <div class="method-content">
                                        <span class="method-icon">üÖøÔ∏è</span>
                                        <span class="method-name">PayPal</span>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- D√©tails carte -->
                        <div class="card-details" id="cardDetails">
                            <h4>Informations de la carte</h4>
                            
                            <div class="form-group">
                                <label for="cardNumber">Num√©ro de carte</label>
                                <input type="text" id="cardNumber" class="input-field" placeholder="1234 5678 9012 3456" maxlength="19" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expiryDate">Date d'expiration</label>
                                    <input type="text" id="expiryDate" class="input-field" placeholder="MM/AA" maxlength="5" required>
                                </div>
                                <div class="form-group">
                                    <label for="cvv">CVV</label>
                                    <input type="text" id="cvv" class="input-field" placeholder="123" maxlength="4" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="cardName">Nom sur la carte</label>
                                <input type="text" id="cardName" class="input-field" placeholder="Jean Dupont" required>
                            </div>
                        </div>

                        <!-- D√©tails PayPal -->
                        <div class="paypal-details hidden" id="paypalDetails">
                            <div class="paypal-info">
                                <p>Vous serez redirig√© vers PayPal pour finaliser votre paiement en toute s√©curit√©.</p>
                                <div class="paypal-button">
                                    <button class="paypal-btn">
                                        üÖøÔ∏è Payer avec PayPal
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- R√©sum√© de commande -->
                        <div class="order-summary">
                            <h4>R√©sum√© de votre commande</h4>
                            <div class="summary-content" id="orderSummary">
                                <!-- Contenu g√©n√©r√© dynamiquement -->
                            </div>
                        </div>

                        <!-- Conditions -->
                        <div class="terms-section">
                            <label class="checkbox-label">
                                <input type="checkbox" id="acceptTerms" required>
                                <span class="checkmark"></span>
                                J'accepte les <a href="#" target="_blank">conditions g√©n√©rales</a> 
                                et la <a href="#" target="_blank">politique de confidentialit√©</a>
                            </label>
                            
                            <label class="checkbox-label">
                                <input type="checkbox" id="newsletter">
                                <span class="checkmark"></span>
                                Je souhaite recevoir les actualit√©s FORNAP par email
                            </label>
                        </div>

                        <!-- Actions -->
                        <div class="payment-actions">
                            <button type="button" class="btn btn-secondary btn-large" onclick="goBackToAuth()">
                                ‚Üê Retour
                            </button>
                            <button type="button" id="processPaymentBtn" class="btn btn-primary btn-large">
                                Finaliser le paiement
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Placeholder pour le footer - sera remplac√© par le composant -->
    <div id="footer-placeholder"></div>

    <!-- ========================================
         MODAL DE CHARGEMENT
         ======================================== -->
    <div id="loadingModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <h3>Traitement en cours...</h3>
                <p id="loadingText">Pr√©paration de votre adh√©sion</p>
                <div class="loading-steps">
                    <div class="step" id="loadingStep1">‚úì V√©rification des informations</div>
                    <div class="step" id="loadingStep2">üîÑ Traitement du paiement</div>
                    <div class="step" id="loadingStep3">üìÑ Cr√©ation du compte membre</div>
                    <div class="step" id="loadingStep4">üéâ Finalisation</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================
         CONTAINER MESSAGES
         ======================================== -->
    <div id="messageContainer"></div>

    <!-- ========================================
         SCRIPTS FIREBASE
         ======================================== -->
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore-compat.js"></script>

    <!-- ========================================
         MODULES FORNAP
         ======================================== -->
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/auth-service.js"></script>
    <script src="../assets/js/components.js"></script>

    <!-- ========================================
         JAVASCRIPT PRINCIPAL
         ======================================== -->
    
    <script>
        console.log('üöÄ FORNAP - Payment');

        // Variables globales
        let currentUser = null;
        let selectedPlan = null;
        let currentStep = 'auth';

        // Fonctions utilitaires
        function showMessage(message, type = 'info') {
            const container = document.getElementById('messageContainer');
            if (!container) {
                // Cr√©er le container s'il n'existe pas
                const messageContainer = document.createElement('div');
                messageContainer.id = 'messageContainer';
                document.body.appendChild(messageContainer);
            }
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${type}`;
            messageElement.textContent = message;
            document.getElementById('messageContainer').appendChild(messageElement);

            setTimeout(() => messageElement.classList.add('show'), 100);
            setTimeout(() => {
                messageElement.classList.remove('show');
                setTimeout(() => messageElement.remove(), 300);
            }, 4000);
        }

        async function handleLogout() {
            try {
                await FornapAuth.signOut();
                showMessage('D√©connexion r√©ussie', 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1000);
            } catch (error) {
                console.error('‚ùå Erreur d√©connexion:', error);
                showMessage('Erreur lors de la d√©connexion', 'error');
            }
        }

        function showLoginModal() {
            showMessage('Connectez-vous d\'abord sur la page d\'accueil', 'info');
            setTimeout(() => {
                window.location.href = '../index.html';
            }, 2000);
        }

        // Initialisation sp√©cifique √† la page de paiement
        function initPageSpecific() {
            // Charger le forfait s√©lectionn√©
            loadSelectedPlan();
            
            // Initialiser les √©v√©nements de formulaire
            initFormEvents();
            
            // Initialiser les m√©thodes de paiement
            initPaymentMethods();
        }

        function loadSelectedPlan() {
            try {
                const storedPlan = sessionStorage.getItem('selectedPlan');
                if (storedPlan) {
                    selectedPlan = JSON.parse(storedPlan);
                    displayPlanSummary(selectedPlan);
                    displayOrderSummary(selectedPlan);
                } else {
                    showMessage('Aucun forfait s√©lectionn√©. Redirection...', 'warning');
                    setTimeout(() => {
                        window.location.href = 'membership.html';
                    }, 2000);
                }
            } catch (error) {
                console.error('‚ùå Erreur chargement forfait:', error);
                showMessage('Erreur lors du chargement du forfait', 'error');
            }
        }

        function displayPlanSummary(plan) {
            const planSummary = document.getElementById('planSummary');
            if (planSummary) {
                planSummary.innerHTML = `
                    <div class="plan-summary-content">
                        <div class="plan-info">
                            <h3>${plan.name}</h3>
                            <div class="plan-price">${plan.price}‚Ç¨${plan.period}</div>
                        </div>
                        <div class="plan-features">
                            <p><strong>Ce qui est inclus :</strong></p>
                            <ul>
                                ${plan.features ? plan.features.map(feature => `<li>${feature}</li>`).join('') : ''}
                            </ul>
                        </div>
                    </div>
                `;
            }
        }

        function displayOrderSummary(plan) {
            const orderSummary = document.getElementById('orderSummary');
            if (orderSummary) {
                const price = plan.price === 'special' ? 0 : plan.price;
                orderSummary.innerHTML = `
                    <div class="summary-line">
                        <span>Forfait ${plan.name}</span>
                        <span>${price}‚Ç¨</span>
                    </div>
                    <div class="summary-line">
                        <span>TVA (20%)</span>
                        <span>${(price * 0.2).toFixed(2)}‚Ç¨</span>
                    </div>
                    <div class="summary-line total">
                        <span><strong>Total</strong></span>
                        <span><strong>${(price * 1.2).toFixed(2)}‚Ç¨</strong></span>
                    </div>
                `;
            }
        }

        function initFormEvents() {
            // Inscription
            const signupBtn = document.getElementById('signupBtn');
            if (signupBtn) {
                signupBtn.addEventListener('click', handleSignup);
            }

            // Connexion
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
                loginBtn.addEventListener('click', handleLogin);
            }

            // Paiement
            const processPaymentBtn = document.getElementById('processPaymentBtn');
            if (processPaymentBtn) {
                processPaymentBtn.addEventListener('click', handlePayment);
            }

            // Formatage des champs
            formatCardInputs();
        }

        function initPaymentMethods() {
            const methodOptions = document.querySelectorAll('input[name="paymentMethod"]');
            methodOptions.forEach(option => {
                option.addEventListener('change', handlePaymentMethodChange);
            });
        }

        function handlePaymentMethodChange(e) {
            const cardDetails = document.getElementById('cardDetails');
            const paypalDetails = document.getElementById('paypalDetails');
            
            if (e.target.value === 'card') {
                cardDetails.classList.remove('hidden');
                paypalDetails.classList.add('hidden');
            } else {
                cardDetails.classList.add('hidden');
                paypalDetails.classList.remove('hidden');
            }
        }

        async function handleSignup() {
            const firstName = document.getElementById('signupFirstName').value;
            const lastName = document.getElementById('signupLastName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;

            if (!firstName || !lastName || !email || !password) {
                showMessage('Veuillez remplir tous les champs', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showMessage('Les mots de passe ne correspondent pas', 'error');
                return;
            }

            if (password.length < 6) {
                showMessage('Le mot de passe doit contenir au moins 6 caract√®res', 'error');
                return;
            }

            try {
                const user = await FornapAuth.signUp(email, password, {
                    displayName: `${firstName} ${lastName}`,
                    firstName,
                    lastName
                });

                showMessage('Compte cr√©√© avec succ√®s !', 'success');
                showPaymentSection();

            } catch (error) {
                console.error('‚ùå Erreur inscription:', error);
                showMessage(error.message || 'Erreur lors de la cr√©ation du compte', 'error');
            }
        }

        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                showMessage('Veuillez remplir tous les champs', 'error');
                return;
            }

            try {
                const user = await FornapAuth.signIn(email, password);
                showMessage('Connexion r√©ussie !', 'success');
                showPaymentSection();

            } catch (error) {
                console.error('‚ùå Erreur connexion:', error);
                showMessage('Email ou mot de passe incorrect', 'error');
            }
        }

        function showPaymentSection() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('paymentSection').classList.remove('hidden');
            
            // Mettre √† jour la barre de progression
            updateProgressBar('payment');
        }

        function goBackToAuth() {
            document.getElementById('paymentSection').classList.add('hidden');
            document.getElementById('authSection').classList.remove('hidden');
            
            // Mettre √† jour la barre de progression
            updateProgressBar('auth');
        }

        function updateProgressBar(step) {
            const steps = document.querySelectorAll('.progress-step');
            const lines = document.querySelectorAll('.progress-line');
            
            // Reset all
            steps.forEach(s => s.classList.remove('active', 'completed'));
            lines.forEach(l => l.classList.remove('completed'));
            
            if (step === 'auth') {
                steps[1].classList.add('active');
                steps[0].classList.add('completed');
                lines[0].classList.add('completed');
            } else if (step === 'payment') {
                steps[2].classList.add('active');
                steps[0].classList.add('completed');
                steps[1].classList.add('completed');
                lines[0].classList.add('completed');
                lines[1].classList.add('completed');
            }
        }

        async function handlePayment() {
            const acceptTerms = document.getElementById('acceptTerms').checked;
            
            if (!acceptTerms) {
                showMessage('Veuillez accepter les conditions g√©n√©rales', 'error');
                return;
            }

            try {
                showLoadingModal();
                
                // Simulation de paiement
                await simulatePayment();
                
                hideLoadingModal();
                
                // Redirection vers la page de f√©licitations
                showMessage('Paiement trait√© avec succ√®s !', 'success');
                setTimeout(() => {
                    window.location.href = 'profile-setup.html';
                }, 1500);

            } catch (error) {
                hideLoadingModal();
                console.error('‚ùå Erreur paiement:', error);
                showMessage('Erreur lors du traitement du paiement', 'error');
            }
        }

        async function simulatePayment() {
            const steps = [
                { id: 'loadingStep1', delay: 1000 },
                { id: 'loadingStep2', delay: 2000 },
                { id: 'loadingStep3', delay: 1500 },
                { id: 'loadingStep4', delay: 1000 }
            ];

            for (let i = 0; i < steps.length; i++) {
                await new Promise(resolve => {
                    setTimeout(() => {
                        const step = document.getElementById(steps[i].id);
                        if (step) {
                            step.style.color = 'var(--succes)';
                            step.innerHTML = step.innerHTML.replace('üîÑ', '‚úì');
                        }
                        resolve();
                    }, steps[i].delay);
                });
            }
        }

        function showLoadingModal() {
            document.getElementById('loadingModal').classList.remove('hidden');
        }

        function hideLoadingModal() {
            document.getElementById('loadingModal').classList.add('hidden');
        }

        function formatCardInputs() {
            const cardNumber = document.getElementById('cardNumber');
            const expiryDate = document.getElementById('expiryDate');
            const cvv = document.getElementById('cvv');

            if (cardNumber) {
                cardNumber.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                    let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                    e.target.value = formattedValue;
                });
            }

            if (expiryDate) {
                expiryDate.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length >= 2) {
                        value = value.substring(0, 2) + '/' + value.substring(2, 4);
                    }
                    e.target.value = value;
                });
            }

            if (cvv) {
                cvv.addEventListener('input', function(e) {
                    e.target.value = e.target.value.replace(/\D/g, '');
                });
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('‚úÖ DOM charg√© - Payment');

            try {
                // Initialiser les services
                await FornapAuth.init();
                
                // Initialiser les composants
                initFornapComponents();

                // √âcouter les changements d'authentification
                FornapAuth.onAuthStateChanged((user) => {
                    currentUser = user;
                    console.log('üë§ Utilisateur:', user ? user.email : 'd√©connect√©');
                    
                    // Mettre √† jour l'interface via le syst√®me global synchronis√©
                    FornapComponents.syncAuthState(!!user);
                });

                // Initialisation sp√©cifique √† la page
                initPageSpecific();

                console.log('üéØ FORNAP Payment pr√™te !');

            } catch (error) {
                console.error('‚ùå Erreur initialisation:', error);
                showMessage('Erreur lors du chargement. Veuillez recharger la page.', 'error');
            }
        });

        // Initialisation des composants FORNAP
        function initFornapComponents() {
            // Injecter la navbar
            const navbarPlaceholder = document.getElementById('navbar-placeholder');
            if (navbarPlaceholder) {
                navbarPlaceholder.outerHTML = FornapComponents.generateNavbar('payment', '../');
            }

            // Injecter le footer
            const footerPlaceholder = document.getElementById('footer-placeholder');
            if (footerPlaceholder) {
                footerPlaceholder.outerHTML = FornapComponents.generateFooter('../');
            }

            // Initialiser les √©v√©nements apr√®s injection
            setTimeout(() => {
                FornapComponents.initNavbarEvents('../', {
                    onLogin: showLoginModal,
                    onLogout: handleLogout
                });
            }, 100);
        }
    </script>

    <style>
        /* Styles sp√©cifiques √† la page de paiement */
        
        .progress-section {
            background: var(--gris-tres-clair);
            padding: var(--space-6) 0;
            border-bottom: 2px solid var(--noir-principal);
        }

        .progress-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gris-clair);
            color: var(--gris-moyen);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-bold);
            margin-bottom: var(--space-2);
            border: 2px solid var(--gris-clair);
        }

        .step-label {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--gris-moyen);
        }

        .progress-step.completed .step-number {
            background: var(--noir-principal);
            color: var(--blanc-principal);
            border-color: var(--noir-principal);
        }

        .progress-step.completed .step-label {
            color: var(--noir-principal);
        }

        .progress-step.active .step-number {
            background: var(--blanc-principal);
            color: var(--noir-principal);
            border-color: var(--noir-principal);
            transform: scale(1.1);
        }

        .progress-step.active .step-label {
            color: var(--noir-principal);
            font-weight: var(--font-bold);
        }

        .progress-line {
            width: 80px;
            height: 2px;
            background: var(--gris-clair);
            margin: 0 var(--space-4);
        }

        .progress-line.completed {
            background: var(--noir-principal);
        }

        .selected-plan-section {
            padding: var(--space-8) 0;
            background: var(--blanc-principal);
        }

        .plan-summary-card {
            max-width: 600px;
            margin: 0 auto;
            padding: var(--space-6);
            border: 2px solid var(--noir-principal);
            background: var(--gris-tres-clair);
        }

        .plan-summary-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
            align-items: start;
        }

        .plan-info h3 {
            margin-bottom: var(--space-2);
            color: var(--noir-principal);
        }

        .plan-price {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--noir-principal);
        }

        .plan-features ul {
            list-style: none;
            padding: 0;
            margin: var(--space-4) 0 0 0;
        }

        .plan-features li {
            padding: var(--space-1) 0;
            color: var(--gris-moyen);
        }

        .plan-features li::before {
            content: "‚úì ";
            color: var(--succes);
            font-weight: var(--font-bold);
        }

        .auth-section, .payment-section {
            padding: var(--space-12) 0;
            background: var(--blanc-principal);
        }

        .auth-container, .payment-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .auth-card, .payment-card {
            background: var(--blanc-principal);
            border: 2px solid var(--noir-principal);
            padding: var(--space-8);
        }

        .auth-header, .payment-header {
            text-align: center;
            margin-bottom: var(--space-8);
        }

        .auth-header h2, .payment-header h2 {
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .auth-header p, .payment-header p {
            color: var(--gris-moyen);
            line-height: 1.6;
        }

        .demo-notice {
            background: var(--warning-bg);
            color: var(--warning);
            padding: var(--space-3);
            border: 1px solid var(--warning);
            margin-top: var(--space-4);
            text-align: center;
            font-weight: var(--font-medium);
        }

        .auth-form {
            margin-bottom: var(--space-6);
        }

        .auth-form h3 {
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }

        .form-group {
            margin-bottom: var(--space-4);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-2);
            font-weight: var(--font-medium);
            color: var(--noir-principal);
        }

        .input-field {
            width: 100%;
            padding: var(--space-3);
            border: 2px solid var(--gris-clair);
            background: var(--blanc-principal);
            font-size: var(--text-base);
            transition: var(--transition-base);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--noir-principal);
        }

        .auth-separator {
            display: flex;
            align-items: center;
            margin: var(--space-8) 0;
        }

        .separator-line {
            flex: 1;
            height: 1px;
            background: var(--gris-clair);
        }

        .separator-text {
            margin: 0 var(--space-4);
            color: var(--gris-moyen);
            font-weight: var(--font-medium);
        }

        .payment-methods {
            margin-bottom: var(--space-6);
        }

        .payment-methods h3, .payment-methods h4 {
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .method-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }

        .method-option {
            position: relative;
            cursor: pointer;
            display: block;
        }

        .method-option input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .method-content {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-4);
            border: 2px solid var(--gris-clair);
            background: var(--blanc-principal);
            transition: var(--transition-base);
        }

        .method-option:hover .method-content {
            border-color: var(--noir-principal);
        }

        .method-option.active .method-content {
            border-color: var(--noir-principal);
            background: var(--gris-tres-clair);
        }

        .method-icon {
            font-size: var(--text-xl);
        }

        .method-name {
            font-weight: var(--font-medium);
        }

        .card-details, .paypal-details {
            margin-bottom: var(--space-6);
        }

        .paypal-info {
            text-align: center;
            padding: var(--space-6);
        }

        .paypal-button {
            margin-top: var(--space-4);
        }

        .paypal-btn {
            background: #0070ba;
            color: white;
            border: none;
            padding: var(--space-4) var(--space-6);
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            cursor: pointer;
            transition: var(--transition-base);
        }

        .paypal-btn:hover {
            background: #005ea6;
        }

        .order-summary {
            background: var(--gris-tres-clair);
            padding: var(--space-6);
            border: 2px solid var(--noir-principal);
            margin-bottom: var(--space-6);
        }

        .order-summary h4 {
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .summary-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-2) 0;
            border-bottom: 1px solid var(--gris-clair);
        }

        .summary-line.total {
            border-top: 2px solid var(--noir-principal);
            border-bottom: none;
            margin-top: var(--space-2);
            padding-top: var(--space-4);
            font-size: var(--text-lg);
        }

        .terms-section {
            margin-bottom: var(--space-6);
        }

        .checkbox-label {
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            margin-bottom: var(--space-3);
            cursor: pointer;
            line-height: 1.5;
        }

        .checkbox-label input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid var(--gris-clair);
            background: var(--blanc-principal);
            position: relative;
            transition: var(--transition-base);
            flex-shrink: 0;
            margin-top: 2px;
        }

        .checkbox-label:hover .checkmark {
            border-color: var(--noir-principal);
        }

        .checkbox-label input:checked ~ .checkmark {
            background: var(--noir-principal);
            border-color: var(--noir-principal);
        }

        .checkmark::after {
            content: "";
            position: absolute;
            display: none;
            left: 6px;
            top: 2px;
            width: 6px;
            height: 10px;
            border: solid var(--blanc-principal);
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .checkbox-label input:checked ~ .checkmark::after {
            display: block;
        }

        .payment-actions {
            display: flex;
            gap: var(--space-4);
            justify-content: space-between;
        }

        .forgot-password {
            color: var(--noir-principal);
            text-decoration: none;
            font-weight: var(--font-medium);
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        /* Modal de chargement */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
        }

        .modal-content {
            position: relative;
            background: var(--blanc-principal);
            border: 2px solid var(--noir-principal);
            padding: var(--space-8);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .loading-content h3 {
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--gris-clair);
            border-top: 4px solid var(--noir-principal);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--space-4);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-steps {
            margin-top: var(--space-6);
            text-align: left;
        }

        .loading-steps .step {
            padding: var(--space-2) 0;
            color: var(--gris-moyen);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .plan-summary-content {
                grid-template-columns: 1fr;
                gap: var(--space-4);
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .method-options {
                grid-template-columns: 1fr;
            }

            .payment-actions {
                flex-direction: column;
            }

            .progress-bar {
                padding: 0 var(--space-4);
            }

            .progress-line {
                width: 40px;
                margin: 0 var(--space-2);
            }

            .step-label {
                font-size: var(--text-xs);
            }

            .auth-card, .payment-card {
                padding: var(--space-6);
            }
        }

        @media (max-width: 480px) {
            .step-label {
                display: none;
            }

            .progress-line {
                width: 30px;
                margin: 0 var(--space-1);
            }
        }
    </style>
</body>
</html> 