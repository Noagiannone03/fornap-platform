<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finaliser votre profil - FORNAP</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/components.css">
</head>
<body>
    <!-- Placeholder pour la navbar - sera remplac√©e par le composant -->
    <div id="navbar-placeholder"></div>

    <!-- ========================================
         CONTENU PRINCIPAL
         ======================================== -->
    <main class="main-content">
        
        <!-- Section Hero -->
        <section class="hero">
            <div class="container">
                <h1>Finaliser votre profil FORNAP</h1>
                <p>Quelques informations suppl√©mentaires pour personnaliser votre exp√©rience membre</p>
                
                <!-- Barre de progression -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-steps">
                        <div class="progress-step active" id="step1">
                            <span class="step-number">1</span>
                            <span class="step-label">Informations personnelles</span>
                        </div>
                        <div class="progress-step" id="step2">
                            <span class="step-number">2</span>
                            <span class="step-label">Pr√©f√©rences</span>
                        </div>
                        <div class="progress-step" id="step3">
                            <span class="step-number">3</span>
                            <span class="step-label">Communication</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Formulaire -->
        <section class="form-section">
            <div class="container">
                <div class="form-container">
                    
                    <!-- √âtape 1: Informations personnelles -->
                    <div class="form-step active" id="formStep1">
                        <div class="step-header">
                            <h2>Informations personnelles</h2>
                            <p>Ces informations nous aident √† personnaliser votre exp√©rience</p>
                        </div>

                        <div class="form-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="firstName">Pr√©nom *</label>
                                    <input type="text" id="firstName" class="form-input" required placeholder="Jean">
                                </div>
                                
                                <div class="form-group">
                                    <label for="lastName">Nom *</label>
                                    <input type="text" id="lastName" class="form-input" required placeholder="Dupont">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="phone">T√©l√©phone</label>
                                    <input type="tel" id="phone" class="form-input" placeholder="06 12 34 56 78">
                                </div>
                                
                                <div class="form-group">
                                    <label for="birthDate">Date de naissance</label>
                                    <input type="date" id="birthDate" class="form-input">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="postalCode">Code postal</label>
                                    <input type="text" id="postalCode" class="form-input" placeholder="75001" maxlength="5" pattern="[0-9]{5}">
                                </div>
                                
                                <div class="form-group">
                                    <label for="profession">Profession</label>
                                    <select id="profession" class="form-select">
                                        <option value="">Choisir...</option>
                                        <option value="freelance">Freelance / Ind√©pendant</option>
                                        <option value="entrepreneur">Entrepreneur</option>
                                        <option value="salarie">Salari√©</option>
                                        <option value="etudiant">√âtudiant</option>
                                        <option value="developer">D√©veloppeur</option>
                                        <option value="designer">Designer</option>
                                        <option value="marketing">Marketing / Communication</option>
                                        <option value="consultant">Consultant</option>
                                        <option value="commercial">Commercial</option>
                                        <option value="finance">Finance / Comptabilit√©</option>
                                        <option value="juridique">Juridique</option>
                                        <option value="sante">Sant√©</option>
                                        <option value="education">√âducation</option>
                                        <option value="art">Arts / Culture</option>
                                        <option value="autre">Autre</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="company">Entreprise / Organisation (optionnel)</label>
                                <input type="text" id="company" class="form-input" placeholder="Nom de votre entreprise">
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn btn-primary" onclick="nextStep(2)">
                                Continuer
                            </button>
                        </div>
                    </div>

                    <!-- √âtape 2: Pr√©f√©rences -->
                    <div class="form-step" id="formStep2">
                        <div class="step-header">
                            <h2>Vos pr√©f√©rences</h2>
                            <p>Aidez-nous √† vous proposer du contenu et des √©v√©nements qui vous int√©ressent</p>
                        </div>

                        <div class="form-content">
                            <div class="form-group">
                                <label>Centres d'int√©r√™t (s√©lectionner tout ce qui vous int√©resse)</label>
                                <div class="interest-grid">
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="networking">
                                        <span class="interest-label">ü§ù Networking</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="tech">
                                        <span class="interest-label">üíª Technologie</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="design">
                                        <span class="interest-label">üé® Design</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="startup">
                                        <span class="interest-label">üöÄ Startups</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="marketing">
                                        <span class="interest-label">üìà Marketing</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="finance">
                                        <span class="interest-label">üí∞ Finance</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="art">
                                        <span class="interest-label">üé≠ Arts & Culture</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="wellness">
                                        <span class="interest-label">üßò Bien-√™tre</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="formation">
                                        <span class="interest-label">üìö Formation</span>
                                    </label>
                                    
                                    <label class="interest-item">
                                        <input type="checkbox" name="interests" value="sustainability">
                                        <span class="interest-label">üå± D√©veloppement durable</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="workingStyle">Style de travail pr√©f√©r√©</label>
                                <select id="workingStyle" class="form-select">
                                    <option value="">Choisir...</option>
                                    <option value="quiet">Environnement calme</option>
                                    <option value="collaborative">Espaces collaboratifs</option>
                                    <option value="flexible">Flexible selon les projets</option>
                                    <option value="private">Espaces priv√©s</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="visitFrequency">Fr√©quence de visite pr√©vue</label>
                                <select id="visitFrequency" class="form-select">
                                    <option value="">Choisir...</option>
                                    <option value="daily">Quotidienne</option>
                                    <option value="few-times-week">Plusieurs fois par semaine</option>
                                    <option value="weekly">Hebdomadaire</option>
                                    <option value="monthly">Mensuelle</option>
                                    <option value="occasionally">Occasionnelle</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="motivations">Qu'est-ce qui vous motive le plus chez FORNAP ?</label>
                                <textarea id="motivations" class="form-textarea" rows="4" 
                                          placeholder="Partagez ce qui vous attire dans notre communaut√©..."></textarea>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn btn-secondary" onclick="previousStep(1)">
                                Retour
                            </button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(3)">
                                Continuer
                            </button>
                        </div>
                    </div>

                    <!-- √âtape 3: Communication -->
                    <div class="form-step" id="formStep3">
                        <div class="step-header">
                            <h2>Pr√©f√©rences de communication</h2>
                            <p>Choisissez comment vous souhaitez rester inform√© des nouveaut√©s FORNAP</p>
                        </div>

                        <div class="form-content">
                            <div class="form-group">
                                <label>Notifications par email</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="emailEvents" checked>
                                        <span class="checkmark"></span>
                                        √âv√©nements et ateliers
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="emailNews">
                                        <span class="checkmark"></span>
                                        Newsletter mensuelle
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="emailOffers">
                                        <span class="checkmark"></span>
                                        Offres sp√©ciales et promotions
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="emailCommunity">
                                        <span class="checkmark"></span>
                                        Actualit√©s de la communaut√©
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="communicationFrequency">Fr√©quence des communications</label>
                                <select id="communicationFrequency" class="form-select">
                                    <option value="realtime">En temps r√©el</option>
                                    <option value="daily">R√©sum√© quotidien</option>
                                    <option value="weekly" selected>R√©sum√© hebdomadaire</option>
                                    <option value="monthly">R√©sum√© mensuel</option>
                                    <option value="minimal">Communications essentielles uniquement</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Canaux de communication pr√©f√©r√©s</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="channelEmail" checked>
                                        <span class="checkmark"></span>
                                        üìß Email
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="channelSMS">
                                        <span class="checkmark"></span>
                                        üì± SMS (√©v√©nements urgents)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="channelApp">
                                        <span class="checkmark"></span>
                                        üîî Notifications app (√† venir)
                                    </label>
                                </div>
                            </div>

                            <div class="privacy-notice">
                                <h4>üîí Confidentialit√©</h4>
                                <p>Vos donn√©es sont trait√©es conform√©ment √† notre <a href="#" target="_blank">politique de confidentialit√©</a>. 
                                   Vous pouvez modifier ces pr√©f√©rences √† tout moment depuis votre dashboard membre.</p>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn btn-secondary" onclick="previousStep(2)">
                                Retour
                            </button>
                            <button type="button" class="btn btn-primary" id="finalizeProfile">
                                Finaliser mon profil
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Placeholder pour le footer - sera remplac√© par le composant -->
    <div id="footer-placeholder"></div>

    <!-- ========================================
         MODAL DE CHARGEMENT
         ======================================== -->
    <div id="loadingModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <h3 id="loadingTitle">Finalisation de votre profil...</h3>
                <p id="loadingMessage">Veuillez patienter pendant que nous configurons votre espace membre</p>
            </div>
        </div>
    </div>

    <!-- ========================================
         CONTAINER MESSAGES
         ======================================== -->
    <div id="messageContainer"></div>

    <!-- ========================================
         SCRIPTS FIREBASE
         ======================================== -->
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore-compat.js"></script>

    <!-- ========================================
         JAVASCRIPT PRINCIPAL
         ======================================== -->
    
    <script>
        console.log('üöÄ FORNAP - Profile Setup');

        // Variables globales
        let currentUser = null;

        // Fonctions utilitaires
        function showMessage(message, type = 'info') {
            const container = document.getElementById('messageContainer');
            if (!container) {
                // Cr√©er le container s'il n'existe pas
                const messageContainer = document.createElement('div');
                messageContainer.id = 'messageContainer';
                document.body.appendChild(messageContainer);
            }
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${type}`;
            messageElement.textContent = message;
            document.getElementById('messageContainer').appendChild(messageElement);

            setTimeout(() => messageElement.classList.add('show'), 100);
            setTimeout(() => {
                messageElement.classList.remove('show');
                setTimeout(() => messageElement.remove(), 300);
            }, 4000);
        }

        async function handleLogout() {
            try {
                await FornapAuth.signOut();
                showMessage('D√©connexion r√©ussie', 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1000);
            } catch (error) {
                console.error('‚ùå Erreur d√©connexion:', error);
                showMessage('Erreur lors de la d√©connexion', 'error');
            }
        }

        function showLoginModal() {
            showMessage('Connectez-vous d\'abord sur la page d\'accueil', 'info');
            setTimeout(() => {
                window.location.href = '../index.html';
            }, 2000);
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('‚úÖ DOM charg√© - Profile Setup');

            try {
                // Initialiser les services
                await FornapAuth.init();
                
                // Initialiser les composants
                initFornapComponents();

                // √âcouter les changements d'authentification
                FornapAuth.onAuthStateChanged((user) => {
                    currentUser = user;
                    console.log('üë§ Utilisateur:', user ? user.email : 'd√©connect√©');
                    
                    // Mettre √† jour l'interface via le syst√®me global synchronis√©
                    FornapComponents.syncAuthState(!!user);
                });

                // Initialisation sp√©cifique √† la page
                if (typeof initPageSpecific === 'function') {
                    initPageSpecific();
                }

                console.log('üéØ FORNAP Profile Setup pr√™te !');

            } catch (error) {
                console.error('‚ùå Erreur initialisation:', error);
                showMessage('Erreur lors du chargement. Veuillez recharger la page.', 'error');
            }
        });

        // Initialisation des composants FORNAP
        function initFornapComponents() {
            // Injecter la navbar
            const navbarPlaceholder = document.getElementById('navbar-placeholder');
            if (navbarPlaceholder) {
                navbarPlaceholder.outerHTML = FornapComponents.generateNavbar('profile setup', '../');
            }

            // Injecter le footer
            const footerPlaceholder = document.getElementById('footer-placeholder');
            if (footerPlaceholder) {
                footerPlaceholder.outerHTML = FornapComponents.generateFooter('../');
            }

            // Initialiser les √©v√©nements apr√®s injection
            setTimeout(() => {
                FornapComponents.initNavbarEvents('../', {
                    onLogin: showLoginModal,
                    onLogout: handleLogout
                });
            }, 100);
        }
    </script>

</body>
</html> 