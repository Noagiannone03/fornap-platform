<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template FORNAP - Modularis√©</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/components.css">
</head>
<body>
    <!-- Navbar (inject√©e par les composants) -->
    <div id="navbar-placeholder"></div>

    <!-- Contenu principal -->
    <main class="main-content">
        <section class="hero">
            <div class="container">
                <h1>Page Template FORNAP</h1>
                <p>Exemple d'utilisation des modules r√©organis√©s</p>
                
                <!-- Boutons de test -->
                <div class="flex gap-4 justify-center mt-8">
                    <button class="btn btn-primary" onclick="testAuth()">Test Auth</button>
                    <button class="btn btn-secondary" onclick="testMessages()">Test Messages</button>
                    <button class="btn btn-success" onclick="testUtils()">Test Utils</button>
                </div>
            </div>
        </section>
        
        <!-- Section de test -->
        <section class="py-16">
            <div class="container">
                <div class="form-container">
                    <h2 class="text-center mb-6">Tests des Modules</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="testEmail">Email de test</label>
                            <input type="email" id="testEmail" class="form-input" placeholder="test@fornap.fr">
                        </div>
                        <div class="form-group">
                            <label for="testPassword">Mot de passe</label>
                            <input type="password" id="testPassword" class="form-input" placeholder="motdepasse">
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button class="btn btn-primary" onclick="testSignUp()">Test Inscription</button>
                        <button class="btn btn-outline" onclick="testSignIn()">Test Connexion</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer (inject√© par les composants) -->
    <div id="footer-placeholder"></div>

    <!-- ========================================
         SCRIPTS FIREBASE
         ======================================== -->
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore-compat.js"></script>
    
    <!-- ========================================
         MODULES FORNAP
         ======================================== -->
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/auth-service.js"></script>
    <script src="../assets/js/components.js"></script>

    <!-- ========================================
         JAVASCRIPT PRINCIPAL
         ======================================== -->
    
    <script>
        console.log('üöÄ FORNAP - Template');

        // Variables globales
        let currentUser = null;

        // Fonctions utilitaires
        function showMessage(message, type = 'info') {
            const container = document.getElementById('messageContainer');
            if (!container) {
                // Cr√©er le container s'il n'existe pas
                const messageContainer = document.createElement('div');
                messageContainer.id = 'messageContainer';
                document.body.appendChild(messageContainer);
            }
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${type}`;
            messageElement.textContent = message;
            document.getElementById('messageContainer').appendChild(messageElement);

            setTimeout(() => messageElement.classList.add('show'), 100);
            setTimeout(() => {
                messageElement.classList.remove('show');
                setTimeout(() => messageElement.remove(), 300);
            }, 4000);
        }

        async function handleLogout() {
            try {
                await FornapAuth.signOut();
                showMessage('D√©connexion r√©ussie', 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1000);
            } catch (error) {
                console.error('‚ùå Erreur d√©connexion:', error);
                showMessage('Erreur lors de la d√©connexion', 'error');
            }
        }

        function showLoginModal() {
            showMessage('Connectez-vous d\'abord sur la page d\'accueil', 'info');
            setTimeout(() => {
                window.location.href = '../index.html';
            }, 2000);
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('‚úÖ DOM charg√© - Template');

            try {
                // Initialiser les services
                await FornapAuth.init();
                
                // Initialiser les composants
                initFornapComponents();

                // √âcouter les changements d'authentification
                FornapAuth.onAuthStateChanged((user) => {
                    currentUser = user;
                    console.log('üë§ Utilisateur:', user ? user.email : 'd√©connect√©');
                    
                    // Mettre √† jour l'interface via le syst√®me global synchronis√©
                    FornapComponents.syncAuthState(!!user);
                });

                // Initialisation sp√©cifique √† la page
                if (typeof initPageSpecific === 'function') {
                    initPageSpecific();
                }

                console.log('üéØ FORNAP Template pr√™te !');

            } catch (error) {
                console.error('‚ùå Erreur initialisation:', error);
                showMessage('Erreur lors du chargement. Veuillez recharger la page.', 'error');
            }
        });

        // Initialisation des composants FORNAP
        function initFornapComponents() {
            // Injecter la navbar
            const navbarPlaceholder = document.getElementById('navbar-placeholder');
            if (navbarPlaceholder) {
                navbarPlaceholder.outerHTML = FornapComponents.generateNavbar('template', '../');
            }

            // Injecter le footer
            const footerPlaceholder = document.getElementById('footer-placeholder');
            if (footerPlaceholder) {
                footerPlaceholder.outerHTML = FornapComponents.generateFooter('../');
            }

            // Initialiser les √©v√©nements apr√®s injection
            setTimeout(() => {
                FornapComponents.initNavbarEvents('../', {
                    onLogin: showLoginModal,
                    onLogout: handleLogout
                });
            }, 100);
        }
    </script>


    <style>
        /* Styles sp√©cifiques au template */
        .hero {
            padding: var(--space-16) 0;
            background: linear-gradient(135deg, var(--blanc-principal) 0%, var(--gris-tres-clair) 100%);
            text-align: center;
        }

        .hero h1 {
            font-size: var(--text-4xl);
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .hero p {
            font-size: var(--text-lg);
            color: var(--gris-moyen);
            margin-bottom: var(--space-8);
        }

        .py-16 {
            padding: var(--space-16) 0;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: var(--text-2xl);
            }
            
            .flex {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
    <div id="messageContainer"></div>
</body>
</html> 