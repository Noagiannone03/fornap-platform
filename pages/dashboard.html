<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - FORNAP</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/components.css">
</head>
<body>
    <!-- Placeholder pour la navbar - sera remplac√©e par le composant -->
    <div id="navbar-placeholder"></div>

    <!-- ========================================
         CONTENU PRINCIPAL
         ======================================== -->
    <main class="main-content">
        
        <!-- Header du Dashboard -->
        <section class="dashboard-hero">
            <div class="container">
                <div class="hero-content">
                    <div class="welcome-section">
                        <div class="user-avatar">
                            <span id="userInitials">?</span>
                        </div>
                        <div class="welcome-text">
                            <h1>Bonjour <span id="userFirstName">Membre</span> ! üëã</h1>
                            <p class="subtitle">Bienvenue dans votre espace FORNAP</p>
                        </div>
                    </div>
                    
                    <div class="membership-status">
                        <div class="status-badge" id="membershipBadge">
                            <span class="status-indicator"></span>
                            <span class="status-text">Membre Actif</span>
                        </div>
                        <div class="member-id">
                            <span id="memberNumber">N¬∞ FORNAP-...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Statistiques rapides -->
        <section class="quick-stats">
            <div class="container">
                <div class="stats-grid">
                    <div class="stat-card loyalty-stat" id="loyaltyStatCard">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-info">
                            <h3 id="loyaltyPoints">0</h3>
                            <p>Points fid√©lit√©</p>
                            <div class="stat-progress" id="loyaltyProgress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="loyaltyProgressFill"></div>
                                </div>
                                <span class="progress-text" id="loyaltyProgressText"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üé´</div>
                        <div class="stat-info">
                            <h3 id="eventsCount">0</h3>
                            <p>√âv√©nements particip√©s</p>
                            <span class="stat-detail">Ce mois-ci</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üíº</div>
                        <div class="stat-info">
                            <h3 id="coworkingHours">0h</h3>
                            <p>Coworking utilis√©</p>
                            <span class="stat-detail">Ce mois-ci</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-info">
                            <h3 id="savingsAmount">0‚Ç¨</h3>
                            <p>√âconomies r√©alis√©es</p>
                            <span class="stat-detail">Avec vos r√©ductions</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Principal -->
        <section class="dashboard-main">
            <div class="container">
                <div class="dashboard-layout">
                    
                    <!-- Colonne principale -->
                    <div class="main-column">
                        
                        <!-- Mon abonnement -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>üé´ Mon Abonnement</h3>
                                <button class="btn btn-secondary btn-small">Modifier</button>
                            </div>
                            <div class="card-content">
                                <div class="subscription-info">
                                    <div class="subscription-plan">
                                        <h4 id="planName">Membre Mensuel</h4>
                                        <p class="plan-price"><span id="planPrice">12‚Ç¨</span><span id="planPeriod">/mois</span></p>
                                    </div>
                                    <div class="subscription-status">
                                        <span class="status active">‚óè Actif</span>
                                        <p class="renewal-date">Renouvellement : <span id="renewalDate">Non d√©fini</span></p>
                                    </div>
                                </div>
                                
                                <div class="subscription-features" id="subscriptionFeatures">
                                    <!-- G√©n√©r√© dynamiquement -->
                                </div>
                            </div>
                        </div>

                        <!-- Programme de fid√©lit√© - Conditionnel -->
                        <div class="dashboard-card" id="loyaltyCard">
                            <div class="card-header">
                                <h3>‚≠ê Programme de Fid√©lit√©</h3>
                                <div class="loyalty-tier" id="loyaltyTier">Bronze</div>
                            </div>
                            <div class="card-content" id="loyaltyContent">
                                <!-- Contenu g√©n√©r√© dynamiquement -->
                            </div>
                        </div>

                        <!-- Activit√© r√©cente -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>üìà Activit√© R√©cente</h3>
                                <a href="#" class="view-all">Voir tout</a>
                            </div>
                            <div class="card-content">
                                <div class="activity-list" id="activityList">
                                    <div class="activity-item">
                                        <div class="activity-icon">üéØ</div>
                                        <div class="activity-info">
                                            <p><strong>Inscription r√©ussie !</strong></p>
                                            <span class="activity-date">Aujourd'hui</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Colonne secondaire -->
                    <div class="side-column">
                        
                        <!-- Mon profil -->
                        <div class="dashboard-card profile-card">
                            <div class="card-header">
                                <h3>üë§ Mon Profil</h3>
                                <button class="btn btn-secondary btn-small" onclick="editProfile()">Modifier</button>
                            </div>
                            <div class="card-content">
                                <div class="profile-summary" id="profileSummary">
                                    <!-- G√©n√©r√© dynamiquement -->
                                </div>
                            </div>
                        </div>

                        <!-- Prochains √©v√©nements -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>üéâ Prochains √âv√©nements</h3>
                            </div>
                            <div class="card-content">
                                <div class="event-item">
                                    <div class="event-date">
                                        <span class="day">25</span>
                                        <span class="month">JAN</span>
                                    </div>
                                    <div class="event-info">
                                        <h4>Networking Friday</h4>
                                        <p>18h30 - FORNAP</p>
                                        <span class="event-status available">Places disponibles</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Actions rapides -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>‚ö° Actions Rapides</h3>
                            </div>
                            <div class="card-content">
                                <div class="quick-actions">
                                    <button class="action-btn">
                                        <span class="action-icon">üè¢</span>
                                        <span>R√©server Coworking</span>
                                    </button>
                                    <button class="action-btn">
                                        <span class="action-icon">üõçÔ∏è</span>
                                        <span>Boutique</span>
                                    </button>
                                    <button class="action-btn">
                                        <span class="action-icon">üé´</span>
                                        <span>√âv√©nements</span>
                                    </button>
                                    <button class="action-btn">
                                        <span class="action-icon">üìû</span>
                                        <span>Support</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal de mise √† niveau -->
    <div id="upgradeModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeUpgradeModal()"></div>
        <div class="modal-content">
            <div class="upgrade-content">
                <h3>üöÄ Passez au Membre Annuel !</h3>
                <p>D√©bloquez le programme de fid√©lit√© et bien plus encore :</p>
                <ul>
                    <li>‚≠ê Programme de fid√©lit√© avec r√©compenses</li>
                    <li>üéØ Acc√®s anticip√© aux √©v√©nements</li>
                    <li>üí∞ R√©ductions suppl√©mentaires (-20%)</li>
                    <li>üéÅ Avantages VIP exclusifs</li>
                </ul>
                <div class="upgrade-actions">
                    <button class="btn btn-primary" onclick="upgradeMembership()">
                        Passer √† l'annuel
                    </button>
                    <button class="btn btn-secondary" onclick="closeUpgradeModal()">
                        Plus tard
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Container pour les messages -->
    <div id="messageContainer"></div>

    <!-- Placeholder pour le footer - sera remplac√© par le composant -->
    <div id="footer-placeholder"></div>

    <!-- ========================================
         SCRIPTS FIREBASE
         ======================================== -->
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore-compat.js"></script>

    <!-- ========================================
         MODULES FORNAP
         ======================================== -->
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/auth-service.js"></script>
    <script src="../assets/js/components.js"></script>

    <!-- ========================================
         JAVASCRIPT PRINCIPAL
         ======================================== -->
    
    <script>
        console.log('üöÄ FORNAP - Dashboard');

        // Variables globales
        let currentUser = null;
        let userData = null;

        // Fonctions utilitaires
        function showMessage(message, type = 'info') {
            const container = document.getElementById('messageContainer');
            if (!container) {
                // Cr√©er le container s'il n'existe pas
                const messageContainer = document.createElement('div');
                messageContainer.id = 'messageContainer';
                document.body.appendChild(messageContainer);
            }
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${type}`;
            messageElement.textContent = message;
            document.getElementById('messageContainer').appendChild(messageElement);

            setTimeout(() => messageElement.classList.add('show'), 100);
            setTimeout(() => {
                messageElement.classList.remove('show');
                setTimeout(() => messageElement.remove(), 300);
            }, 4000);
        }

        async function handleLogout() {
            try {
                await FornapAuth.signOut();
                showMessage('D√©connexion r√©ussie', 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1000);
            } catch (error) {
                console.error('‚ùå Erreur d√©connexion:', error);
                showMessage('Erreur lors de la d√©connexion', 'error');
            }
        }

        function showLoginModal() {
            showMessage('Connectez-vous d\'abord sur la page d\'accueil', 'info');
            setTimeout(() => {
                window.location.href = '../index.html';
            }, 2000);
        }

        // Initialisation sp√©cifique au dashboard
        function initPageSpecific() {
            console.log('üéØ Initialisation sp√©cifique Dashboard');
            
            if (currentUser) {
                loadUserData();
            } else {
                // Rediriger vers la page d'accueil si pas connect√©
                showMessage('Veuillez vous connecter pour acc√©der au dashboard', 'warning');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 2000);
            }
        }

        async function loadUserData() {
            try {
                console.log('üìä Chargement des donn√©es utilisateur...');
                
                userData = await FornapAuth.getUserData();
                if (userData) {
                    displayUserInfo(userData);
                    displaySubscriptionInfo(userData);
                    displayLoyaltyInfo(userData);
                    displayProfileInfo(userData);
                    displayStats(userData);
                } else {
                    console.log('‚ö†Ô∏è Donn√©es utilisateur non trouv√©es');
                    showMessage('Probl√®me de chargement des donn√©es utilisateur', 'warning');
                }
                
            } catch (error) {
                console.error('‚ùå Erreur chargement donn√©es:', error);
                showMessage('Erreur lors du chargement de vos donn√©es', 'error');
            }
        }

        function displayUserInfo(data) {
            // Affichage des informations utilisateur dans le header
            const userFirstName = document.getElementById('userFirstName');
            const userInitials = document.getElementById('userInitials');
            const memberNumber = document.getElementById('memberNumber');

            if (userFirstName && data.profile?.firstName) {
                userFirstName.textContent = data.profile.firstName;
            }

            if (userInitials && data.profile?.firstName && data.profile?.lastName) {
                userInitials.textContent = 
                    data.profile.firstName.charAt(0).toUpperCase() + 
                    data.profile.lastName.charAt(0).toUpperCase();
            }

            if (memberNumber && data.uid) {
                memberNumber.textContent = `N¬∞ FORNAP-${data.uid.slice(-6).toUpperCase()}`;
            }
        }

        function displaySubscriptionInfo(data) {
            const planName = document.getElementById('planName');
            const planPrice = document.getElementById('planPrice');
            const planPeriod = document.getElementById('planPeriod');
            const renewalDate = document.getElementById('renewalDate');
            const subscriptionFeatures = document.getElementById('subscriptionFeatures');

            // Donn√©es par d√©faut si pas d'abonnement d√©fini
            const membership = data.membership || {
                plan: 'mensuel',
                status: 'active'
            };

            const plan = window.FornapConfig.membershipPlans[membership.plan] || 
                         window.FornapConfig.membershipPlans.mensuel;

            if (planName) planName.textContent = plan.name;
            if (planPrice) planPrice.textContent = plan.price + '‚Ç¨';
            if (planPeriod) planPeriod.textContent = plan.period;

            if (renewalDate) {
                const nextRenewal = new Date();
                nextRenewal.setMonth(nextRenewal.getMonth() + 1);
                renewalDate.textContent = nextRenewal.toLocaleDateString('fr-FR');
            }

            if (subscriptionFeatures && plan.features) {
                subscriptionFeatures.innerHTML = `
                    <ul class="features-list">
                        ${plan.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                `;
            }
        }

        function displayLoyaltyInfo(data) {
            const loyaltyCard = document.getElementById('loyaltyCard');
            const loyaltyStatCard = document.getElementById('loyaltyStatCard');
            const loyaltyContent = document.getElementById('loyaltyContent');
            const loyaltyTier = document.getElementById('loyaltyTier');
            const loyaltyPoints = document.getElementById('loyaltyPoints');

            const membership = data.membership || { plan: 'mensuel' };
            const plan = window.FornapConfig.membershipPlans[membership.plan];
            const isLoyaltyEnabled = plan?.loyaltyEnabled || false;

            if (!isLoyaltyEnabled) {
                // D√©sactiver le programme de fid√©lit√© pour les membres mensuels
                if (loyaltyCard) {
                    loyaltyCard.classList.add('loyalty-disabled');
                    loyaltyContent.innerHTML = `
                        <div class="loyalty-upgrade-prompt">
                            <div class="upgrade-icon">üöÄ</div>
                            <h4>Programme de fid√©lit√© non disponible</h4>
                            <p>Passez √† un abonnement annuel pour d√©bloquer le programme de fid√©lit√© !</p>
                            <ul>
                                <li>‚≠ê Gagnez des points √† chaque action</li>
                                <li>üéÅ √âchangez vos points contre des r√©compenses</li>
                                <li>üèÜ D√©bloquez des niveaux exclusifs</li>
                            </ul>
                            <button class="btn btn-primary" onclick="showUpgradeModal()">
                                Passer √† l'annuel
                            </button>
                        </div>
                    `;
                }

                if (loyaltyStatCard) {
                    loyaltyStatCard.classList.add('loyalty-disabled');
                }

                if (loyaltyPoints) {
                    loyaltyPoints.textContent = 'üîí';
                }

                if (loyaltyTier) {
                    loyaltyTier.textContent = 'Non disponible';
                }
            } else {
                // Afficher le programme de fid√©lit√© actif
                const loyalty = data.loyalty || { points: 0, tier: 'bronze' };
                
                if (loyaltyPoints) {
                    loyaltyPoints.textContent = loyalty.points || 0;
                }

                if (loyaltyTier) {
                    loyaltyTier.textContent = loyalty.tier.charAt(0).toUpperCase() + loyalty.tier.slice(1);
                }

                if (loyaltyContent) {
                    loyaltyContent.innerHTML = generateLoyaltyContent(loyalty);
                }

                updateLoyaltyProgress(loyalty);
            }
        }

        function generateLoyaltyContent(loyalty) {
            const tierThresholds = {
                bronze: { min: 0, max: 100, next: 'silver' },
                silver: { min: 100, max: 500, next: 'gold' },
                gold: { min: 500, max: 1000, next: 'platinum' },
                platinum: { min: 1000, max: Infinity, next: null }
            };

            const currentTier = tierThresholds[loyalty.tier] || tierThresholds.bronze;
            const pointsInTier = loyalty.points - currentTier.min;
            const pointsNeeded = currentTier.max - loyalty.points;

            let tierInfo = '';
            if (currentTier.next) {
                tierInfo = `
                    <div class="next-tier-info">
                        <p><strong>Prochain niveau :</strong> ${currentTier.next.charAt(0).toUpperCase() + currentTier.next.slice(1)}</p>
                        <p class="points-needed">Plus que ${pointsNeeded} points !</p>
                    </div>
                `;
            } else {
                tierInfo = `
                    <div class="max-tier-info">
                        <p><strong>üèÜ Niveau maximum atteint !</strong></p>
                        <p>Vous √™tes un membre Platinum premium</p>
                    </div>
                `;
            }

            return `
                <div class="loyalty-details">
                    <div class="tier-info">
                        <span class="current-tier">${loyalty.tier.charAt(0).toUpperCase() + loyalty.tier.slice(1)}</span>
                        <span class="tier-points">${loyalty.points} points</span>
                    </div>
                    ${tierInfo}
                    <div class="rewards-section">
                        <h4>üéÅ R√©compenses disponibles</h4>
                        <div class="rewards-list">
                            ${generateRewardsHTML(loyalty.points)}
                        </div>
                    </div>
                </div>
            `;
        }

        function generateRewardsHTML(points) {
            const rewards = [
                { name: 'Caf√© gratuit', cost: 50, icon: '‚òï' },
                { name: 'Journ√©e coworking', cost: 100, icon: 'üè¢' },
                { name: 'Invite √©v√©nement', cost: 150, icon: 'üé´' },
                { name: 'T-shirt FORNAP', cost: 300, icon: 'üëï' }
            ];

            return rewards.map(reward => `
                <div class="reward-item ${points >= reward.cost ? 'available' : 'locked'}">
                    <span class="reward-icon">${reward.icon}</span>
                    <span class="reward-name">${reward.name}</span>
                    <span class="reward-cost">${reward.cost} pts</span>
                </div>
            `).join('');
        }

        function updateLoyaltyProgress(loyalty) {
            const progressFill = document.getElementById('loyaltyProgressFill');
            const progressText = document.getElementById('loyaltyProgressText');

            const tierThresholds = {
                bronze: { min: 0, max: 100 },
                silver: { min: 100, max: 500 },
                gold: { min: 500, max: 1000 },
                platinum: { min: 1000, max: Infinity }
            };

            const currentTier = tierThresholds[loyalty.tier] || tierThresholds.bronze;
            const pointsInTier = loyalty.points - currentTier.min;
            const tierRange = currentTier.max === Infinity ? 100 : currentTier.max - currentTier.min;
            const progressPercent = Math.min((pointsInTier / tierRange) * 100, 100);

            if (progressFill) {
                progressFill.style.width = progressPercent + '%';
            }

            if (progressText) {
                if (currentTier.max === Infinity) {
                    progressText.textContent = 'Niveau maximum';
                } else {
                    progressText.textContent = `${pointsInTier}/${tierRange} vers le niveau suivant`;
                }
            }
        }

        function displayProfileInfo(data) {
            const profileSummary = document.getElementById('profileSummary');
            
            if (profileSummary && data.profile) {
                profileSummary.innerHTML = `
                    <div class="profile-info">
                        <p><strong>${data.profile.firstName || ''} ${data.profile.lastName || ''}</strong></p>
                        <p class="profile-email">${data.email || ''}</p>
                        <p class="profile-phone">${data.profile.phone || 'T√©l√©phone non renseign√©'}</p>
                        <p class="profile-profession">${data.profile.profession || 'Profession non renseign√©e'}</p>
                        <p class="profile-company">${data.profile.company || 'Entreprise non renseign√©e'}</p>
                    </div>
                `;
            }
        }

        function displayStats(data) {
            // Affichage des statistiques basiques
            const eventsCount = document.getElementById('eventsCount');
            const coworkingHours = document.getElementById('coworkingHours');
            const savingsAmount = document.getElementById('savingsAmount');

            if (eventsCount) eventsCount.textContent = data.stats?.events || 0;
            if (coworkingHours) coworkingHours.textContent = (data.stats?.coworkingHours || 0) + 'h';
            if (savingsAmount) savingsAmount.textContent = (data.stats?.savings || 0) + '‚Ç¨';
        }

        // Fonctions modales et actions
        function showUpgradeModal() {
            document.getElementById('upgradeModal').classList.remove('hidden');
        }

        function closeUpgradeModal() {
            document.getElementById('upgradeModal').classList.add('hidden');
        }

        function upgradeMembership() {
            showMessage('Redirection vers la page de mise √† niveau...', 'info');
            setTimeout(() => {
                window.location.href = 'membership.html';
            }, 1000);
        }

        function editProfile() {
            showMessage('Redirection vers l\'√©dition du profil...', 'info');
            setTimeout(() => {
                window.location.href = 'profile-setup.html';
            }, 1000);
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('‚úÖ DOM charg√© - Dashboard');

            try {
                // Initialiser les services
                await FornapAuth.init();
                
                // Initialiser les composants
                initFornapComponents();

                // √âcouter les changements d'authentification
                FornapAuth.onAuthStateChanged((user) => {
                    currentUser = user;
                    console.log('üë§ Utilisateur:', user ? user.email : 'd√©connect√©');
                    
                    // Mettre √† jour l'interface via le syst√®me global synchronis√©
                    FornapComponents.syncAuthState(!!user);
                    
                    // Charger les donn√©es sp√©cifiques si connect√©
                    if (user) {
                        initPageSpecific();
                    }
                });

                console.log('üéØ FORNAP Dashboard pr√™te !');

            } catch (error) {
                console.error('‚ùå Erreur initialisation:', error);
                showMessage('Erreur lors du chargement. Veuillez recharger la page.', 'error');
            }
        });

        // Initialisation des composants FORNAP
        function initFornapComponents() {
            // Injecter la navbar
            const navbarPlaceholder = document.getElementById('navbar-placeholder');
            if (navbarPlaceholder) {
                navbarPlaceholder.outerHTML = FornapComponents.generateNavbar('dashboard', '../');
            }

            // Injecter le footer
            const footerPlaceholder = document.getElementById('footer-placeholder');
            if (footerPlaceholder) {
                footerPlaceholder.outerHTML = FornapComponents.generateFooter('../');
            }

            // Initialiser les √©v√©nements apr√®s injection
            setTimeout(() => {
                FornapComponents.initNavbarEvents('../', {
                    onLogin: showLoginModal,
                    onLogout: handleLogout
                });
            }, 100);
        }
    </script>

    <style>
        /* ========================================
           STYLES DASHBOARD MODERNE
           ======================================== */
        
        /* Hero Dashboard */
        .dashboard-hero {
            background: linear-gradient(135deg, var(--noir-principal) 0%, #333 100%);
            color: var(--blanc-principal);
            padding: var(--space-8) 0;
            margin-top: -32px; /* Compenser le padding du main-content */
        }

        .hero-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--space-6);
        }

        .welcome-section {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            background: var(--blanc-principal);
            color: var(--noir-principal);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
        }

        .welcome-text h1 {
            font-size: var(--text-3xl);
            margin-bottom: var(--space-2);
            color: var(--blanc-principal);
        }

        .subtitle {
            color: #ccc;
            font-size: var(--text-lg);
        }

        .membership-status {
            text-align: right;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            background: rgba(255, 255, 255, 0.1);
            padding: var(--space-2) var(--space-4);
            margin-bottom: var(--space-2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--succes);
        }

        .member-id {
            font-size: var(--text-sm);
            color: #ccc;
        }

        /* Statistiques rapides */
        .quick-stats {
            padding: var(--space-8) 0;
            background: var(--gris-tres-clair);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-6);
        }

        .stat-card {
            background: var(--blanc-principal);
            border: 2px solid var(--noir-principal);
            padding: var(--space-6);
            display: flex;
            align-items: center;
            gap: var(--space-4);
            transition: var(--transition-base);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card.loyalty-disabled {
            opacity: 0.6;
            background: #f8f9fa;
            border-color: #ccc;
        }

        .stat-icon {
            font-size: var(--text-3xl);
            flex-shrink: 0;
        }

        .stat-info h3 {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            margin-bottom: var(--space-1);
            color: var(--noir-principal);
        }

        .stat-info p {
            color: var(--gris-moyen);
            font-weight: var(--font-medium);
            margin-bottom: var(--space-2);
        }

        .stat-detail {
            font-size: var(--text-sm);
            color: var(--gris-moyen);
        }

        .stat-progress {
            margin-top: var(--space-3);
        }

        .progress-bar {
            height: 4px;
            background: var(--gris-clair);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: var(--space-2);
        }

        .progress-fill {
            height: 100%;
            background: var(--noir-principal);
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: var(--text-xs);
            color: var(--gris-moyen);
        }

        /* Layout principal */
        .dashboard-main {
            padding: var(--space-8) 0;
        }

        .dashboard-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: var(--space-8);
        }

        /* Cards */
        .dashboard-card {
            background: var(--blanc-principal);
            border: 2px solid var(--noir-principal);
            margin-bottom: var(--space-6);
            transition: var(--transition-base);
        }

        .dashboard-card:hover {
            box-shadow: var(--shadow-md);
        }

        .dashboard-card.loyalty-disabled {
            border-color: #ccc;
            background: #f8f9fa;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-6);
            border-bottom: 2px solid var(--noir-principal);
            background: var(--gris-tres-clair);
        }

        .loyalty-disabled .card-header {
            border-bottom-color: #ccc;
            background: #e9ecef;
        }

        .card-header h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--noir-principal);
        }

        .loyalty-disabled .card-header h3 {
            color: #666;
        }

        .card-content {
            padding: var(--space-6);
        }

        /* Abonnement */
        .subscription-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
            margin-bottom: var(--space-6);
        }

        .subscription-plan h4 {
            font-size: var(--text-xl);
            margin-bottom: var(--space-2);
            color: var(--noir-principal);
        }

        .plan-price {
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--noir-principal);
        }

        .subscription-status {
            text-align: right;
        }

        .status.active {
            color: var(--succes);
            font-weight: var(--font-bold);
        }

        .renewal-date {
            font-size: var(--text-sm);
            color: var(--gris-moyen);
            margin-top: var(--space-2);
        }

        .features-list {
            list-style: none;
            margin-top: var(--space-4);
        }

        .features-list li {
            padding: var(--space-2) 0;
            color: var(--gris-moyen);
            border-bottom: 1px solid var(--gris-clair);
        }

        /* Programme de fid√©lit√© */
        .loyalty-tier {
            background: var(--noir-principal);
            color: var(--blanc-principal);
            padding: var(--space-2) var(--space-4);
            font-size: var(--text-sm);
            font-weight: var(--font-bold);
        }

        .loyalty-disabled .loyalty-tier {
            background: #ccc;
        }

        .loyalty-upgrade-prompt {
            text-align: center;
        }

        .upgrade-icon {
            font-size: var(--text-4xl);
            margin-bottom: var(--space-4);
        }

        .loyalty-upgrade-prompt h4 {
            margin-bottom: var(--space-3);
            color: var(--gris-moyen);
        }

        .loyalty-upgrade-prompt ul {
            text-align: left;
            margin: var(--space-4) 0;
            color: var(--gris-moyen);
        }

        .loyalty-details {
            display: grid;
            gap: var(--space-6);
        }

        .tier-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .current-tier {
            font-weight: var(--font-bold);
            font-size: var(--text-lg);
        }

        .tier-points {
            font-size: var(--text-sm);
            color: var(--gris-moyen);
        }

        .next-tier-info, .max-tier-info {
            background: var(--gris-tres-clair);
            padding: var(--space-4);
            border-left: 4px solid var(--noir-principal);
        }

        .points-needed {
            font-size: var(--text-sm);
            color: var(--gris-moyen);
        }

        .rewards-list {
            display: grid;
            gap: var(--space-3);
            margin-top: var(--space-4);
        }

        .reward-item {
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border: 1px solid var(--gris-clair);
            transition: var(--transition-base);
        }

        .reward-item.available {
            border-color: var(--succes);
            background: rgba(40, 167, 69, 0.05);
        }

        .reward-item.locked {
            opacity: 0.5;
        }

        .reward-cost {
            font-size: var(--text-sm);
            font-weight: var(--font-bold);
            color: var(--gris-moyen);
        }

        /* Profil */
        .profile-info p {
            margin-bottom: var(--space-2);
            padding-bottom: var(--space-2);
            border-bottom: 1px solid var(--gris-clair);
        }

        .profile-info p:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .profile-email {
            color: var(--gris-moyen);
            font-size: var(--text-sm);
        }

        .profile-phone, .profile-profession, .profile-company {
            color: var(--gris-moyen);
            font-size: var(--text-sm);
        }

        /* √âv√©nements */
        .event-item {
            display: flex;
            gap: var(--space-4);
            align-items: center;
        }

        .event-date {
            text-align: center;
            min-width: 60px;
        }

        .event-date .day {
            display: block;
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--noir-principal);
        }

        .event-date .month {
            display: block;
            font-size: var(--text-sm);
            color: var(--gris-moyen);
        }

        .event-info h4 {
            margin-bottom: var(--space-1);
            color: var(--noir-principal);
        }

        .event-info p {
            color: var(--gris-moyen);
            margin-bottom: var(--space-2);
        }

        .event-status.available {
            color: var(--succes);
            font-size: var(--text-sm);
            font-weight: var(--font-bold);
        }

        /* Actions rapides */
        .quick-actions {
            display: grid;
            gap: var(--space-3);
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            width: 100%;
            padding: var(--space-4);
            background: var(--blanc-principal);
            border: 2px solid var(--gris-clair);
            color: var(--noir-principal);
            cursor: pointer;
            transition: var(--transition-base);
            font-size: var(--text-base);
        }

        .action-btn:hover {
            border-color: var(--noir-principal);
            background: var(--gris-tres-clair);
        }

        .action-icon {
            font-size: var(--text-lg);
        }

        /* Activit√© */
        .activity-list {
            display: grid;
            gap: var(--space-4);
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            padding: var(--space-4);
            background: var(--gris-tres-clair);
            border-left: 4px solid var(--noir-principal);
        }

        .activity-icon {
            font-size: var(--text-lg);
            flex-shrink: 0;
        }

        .activity-info p {
            margin-bottom: var(--space-1);
        }

        .activity-date {
            font-size: var(--text-sm);
            color: var(--gris-moyen);
        }

        .activity-suggestion {
            border-left-color: var(--attention) !important;
            background: rgba(255, 193, 7, 0.05);
        }

        .activity-suggestion .activity-icon {
            opacity: 0.7;
        }

        /* Modal de mise √† niveau */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
        }

        .modal-content {
            position: relative;
            background: var(--blanc-principal);
            border: 2px solid var(--noir-principal);
            padding: var(--space-8);
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow-lg);
        }

        .upgrade-content h3 {
            margin-bottom: var(--space-4);
            color: var(--noir-principal);
        }

        .upgrade-content ul {
            margin: var(--space-4) 0;
            color: var(--gris-moyen);
        }

        .upgrade-actions {
            display: flex;
            gap: var(--space-4);
            justify-content: center;
            margin-top: var(--space-6);
        }

        /* Utilitaires */
        .view-all {
            color: var(--noir-principal);
            text-decoration: none;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
        }

        .view-all:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content {
                flex-direction: column;
                text-align: center;
                gap: var(--space-4);
            }

            .membership-status {
                text-align: center;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .dashboard-layout {
                grid-template-columns: 1fr;
                gap: var(--space-6);
            }

            .subscription-info {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .subscription-status {
                text-align: center;
            }

            .card-header {
                flex-direction: column;
                gap: var(--space-3);
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .dashboard-hero {
                padding: var(--space-6) 0;
            }

            .welcome-text h1 {
                font-size: var(--text-2xl);
            }

            .user-avatar {
                width: 50px;
                height: 50px;
                font-size: var(--text-lg);
            }

            .stat-card {
                flex-direction: column;
                text-align: center;
                gap: var(--space-3);
            }

            .modal-content {
                padding: var(--space-6);
            }

            .upgrade-actions {
                flex-direction: column;
            }
        }
    </style>
</body>
</html> 